import { _0n } from '../const.js';
import { combine_set, create_shares } from './shares.js';
import { create_share_coeffs, get_share_commits } from './vss.js';
export function gen_refresh_shares(index, threshold, share_max, secrets = []) {
    const sub_coeffs = create_share_coeffs(secrets, threshold - 1);
    const coeffs = [_0n, ...sub_coeffs];
    const shares = create_shares(coeffs, share_max);
    const vss_commits = get_share_commits(sub_coeffs);
    return { vss_commits, idx: index, shares };
}
export function refresh_share(refresh_shares, current_share) {
    const shares = [current_share, ...refresh_shares];
    return combine_set(shares);
}
