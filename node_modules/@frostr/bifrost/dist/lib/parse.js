import Schema from '../schema/index.js';
export function parse_ecdh_message(msg) {
    try {
        const schema = Schema.pkg.ecdh;
        const json = JSON.parse(msg.data);
        const parsed = schema.parse(json);
        return { ...msg, data: parsed };
    }
    catch {
        throw new Error('ecdh message failed validation');
    }
}
export function parse_session_message(msg) {
    try {
        const schema = Schema.sign.session;
        const json = JSON.parse(msg.data);
        const parsed = schema.parse(json);
        return { ...msg, data: parsed };
    }
    catch {
        throw new Error('session message failed validation');
    }
}
export function parse_psig_message(msg) {
    try {
        const schema = Schema.sign.psig_pkg;
        const json = JSON.parse(msg.data);
        const parsed = schema.parse(json);
        return { ...msg, data: parsed };
    }
    catch (err) {
        throw new Error('signature message failed validation');
    }
}
export function parse_group_pkg(group_pkg) {
    try {
        const schema = Schema.pkg.group;
        return schema.parse(group_pkg);
    }
    catch (err) {
        console.log('error:', err);
        throw new Error('group package failed validation');
    }
}
export function parse_share_pkg(share_pkg) {
    try {
        const schema = Schema.pkg.share;
        return schema.parse(share_pkg);
    }
    catch (err) {
        console.log('error:', err);
        throw new Error('share package failed validation');
    }
}
